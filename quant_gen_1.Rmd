---
title: "Exercício Processos Evolutivos"
author: "Diogo Melo"
date: "October 17, 2016"
output:
  html_document:
    toc: true
    toc_float:           
          collapsed: false
          smooth_scroll: false
    number_sections: false
    theme: flatly
    highlight: tango
---
 <style>
   th,td{
     padding:2px 5px 2px 5px;
   }
 </style>
 
# Efeitos médios, aditivos e de dominância

Vamos calcular "na unha" algums parâmetros da genética quantitativa numa população pequena. 

A tabela a seguir traz os genótipos para um locus quantitativo e os fenótipos de 20 indivíduos.

```{r, results="asis", echo = FALSE}
library(xtable)
genotypes = c("AA", "AB", "BB")
phenotypes = 4*c(1, 0.5, -1)
p = 0.6
q = 1 - p
N = 20
pop_index = c(rep(1, floor(N*p^2)), rep(2, floor(N*2*p*q)), rep(3, floor(N*q^2)+1))
pop = phenotypes[pop_index] + 10 + rnorm(N, 0, 0.5)
pop_df = data.frame(genótipos = genotypes[pop_index], fenótipos = pop)
tab = xtable(pop_df, digits = 2, align = "ccc")
print(tab, type="html")
```
<br>
- Usando esses dados, faça um gráfico da média dos fenótipos por classe genotípica.

## Algumas continhas

Usando os mesmos dados, calcule:

- o efeito aditivo e o efeito de dominância do alelo A, represente esses efeitos no gráfico;
- o efeito médio do alelo A;

## Frequências alélicas e efeito médio de um alelo

Vamos agora fazer a mesma coisa para outra população

```{r, results="asis", echo = FALSE}
library(xtable)
genotypes = c("AA", "AB", "BB")
phenotypes = 4*c(1, 0.5, -1)
p = 0.95
q = 1 - p
N = 20
pop_index = c(rep(1, floor(N*p^2)), rep(2, floor(N*2*p*q)), rep(3, floor(N*q^2)+1))
pop = phenotypes[pop_index] + 5 + rnorm(N, 0, 0.5)
pop_df = data.frame(genótipos = genotypes[pop_index], fenótipos = pop)
tab = xtable(pop_df, digits = 2, align = "ccc")
print(tab, type="html")
```
<br>
- Faça o mesmo gráfico de fenótipo por genótipo e cacúle o efeito aditivo, efeito de dominância e efeito médio do alelo.